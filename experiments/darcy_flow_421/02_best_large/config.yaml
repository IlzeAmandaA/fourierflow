wandb:
  project: darcy-flow-421
  group:
  name: 02_best_large
  tags:
    - pde
    - darcy-flow
    - fourier
  notes: ""
datastore:
  type: darcy_flow
  train_path: ${FNO_DATA_ROOT}/piececonst_r421_N1024_smooth1.mat
  test_path: ${FNO_DATA_ROOT}/piececonst_r421_N1024_smooth2.mat
  train_size: 1000
  test_size: 100
  r: 5 # sub-sampling rate
  batch_size: 20
  n_workers: 4
experiment:
  type: fourier_2d_darcy
  conv:
    type: fourier_2d_factorized_parallel
    modes: 12
    width: 32
    linear_out: true
    n_layers: 24
    input_dim: 3
    share_weight: true
    factor: 4
    ff_weight_norm: true
    next_input: add
    gain: 0.1
    dropout: 0.0
    in_dropout: 0.0
    avg_outs: true
  n_steps: 10
  optimizer:
    type: adamw
    lr: 0.001
    weight_decay: 0.0001
  scheduler:
    type: cosine_with_warmup
    num_warmup_steps: 500
    num_training_steps: 10000
    num_cycles: 0.5
  scheduler_config:
    name: learning_rate
    interval: step
    frequency: 1
    monitor: None
trainer:
  gpus: 1
  precision: 32
  max_epochs: 200
checkpointer:
  save_last: true
  save_top_k: 1
  validation_metric: valid_loss
  mode: min
  every_n_train_steps: None
  every_n_val_epochs: 1
  period: 1
