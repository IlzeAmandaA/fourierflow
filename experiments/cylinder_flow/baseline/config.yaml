wandb:
  project: cylinder-flow
  group: baseline
  tags:
    - pde
    - cylinder-flow
    - fourier
  notes: ""
builder:
  type: cylinder_flow
  data_path: ${DATA_ROOT}/cylinder_flow/cylinder_flow.h5
  batch_size: 1
  n_workers: 8
experiment:
  type: mesh_cfd
  node_dim: 11
  edge_dim: 3
  output_dim: 2
  max_accumulations: 1000000
  clip_val: 0.1
  optimizer:
    type: adamw
    lr: 0.0025
    weight_decay: 0.0001
  scheduler:
    type: cosine_with_warmup
    num_warmup_steps: 500
    num_training_steps: 1000000
    num_cycles: 0.5
  scheduler_config:
    name: learning_rate
    interval: step
    frequency: 1
    monitor: None
trainer:
  gpus: 1
  precision: 32
  max_epochs: 1
  stochastic_weight_avg: false
  weights_summary: full
  log_every_n_steps: 1000
  val_check_interval: 10000
  limit_train_batches: 1001000
  limit_val_batches: 1000
  limit_test_batches: 1000
  # Debugging parameters
  log_gpu_memory: None # all
  track_grad_norm: -1 # 2
  fast_dev_run: false # 2
callbacks:
  - type: model_checkpoint
    filename: "{epoch}-{step}-{valid_loss:.5f}"
    save_top_k: 1
    save_last: true
    monitor: valid_loss
    mode: min
    auto_insert_metric_name: true
  - type: learning_rate_monitor
    logging_interval: step
